<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>TypeScript Showcase</title>

    <!-- DaisyUI (includes Tailwind) and Highlight.js + Font Awesome -->
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/typescript@latest/lib/typescriptServices.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      /* Professional palette using approximate colors:
         - Science Blue
         - Shark (dark gray)
         - Athens Gray
         - White
      */
      :root {
        --science-blue: #0b63ff; /* Science Blue (approx) */
        --shark: #1f2933; /* Shark dark gray */
        --athens-gray: #f0f3f5; /* Athens Gray */
        --panel-bg: #ffffff;
        --muted: #6b7280;
      }

      /* small adjustments on top of Tailwind classes */
      body {
        font-family: Inter, ui-sans-serif, system-ui, -apple-system,
          "Segoe UI", Roboto, "Helvetica Neue", Arial;
        background: linear-gradient(180deg, var(--athens-gray), #ffffff 60%);
      }

      .code-block {
        font-size: 0.9rem;
        white-space: pre-wrap;
      }

      .feature-card {
        transition: transform 0.25s ease, box-shadow 0.25s ease;
      }

      .feature-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 14px 30px rgba(16, 24, 40, 0.08);
      }

      .tab-active {
        border-bottom: 3px solid var(--science-blue);
        font-weight: 700;
        color: var(--shark) !important;
      }

      .article-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.45s ease;
      }

      .article-content.show {
        max-height: 2000px;
      }

      /* navbar show/hide */
      .nav-hidden {
        transform: translateY(-100%);
      }

      .nav-visible {
        transform: translateY(0);
      }

      /* mobile menu default hidden */
      .mobile-hidden {
        transform: translateY(-110%);
      }

      #mobile-menu {
        transition: transform 0.28s ease-in-out;
      }

      /* small nice scrollbar for code areas */
      pre::-webkit-scrollbar,
      textarea::-webkit-scrollbar {
        height: 8px;
        width: 8px;
      }

      pre::-webkit-scrollbar-thumb,
      textarea::-webkit-scrollbar-thumb {
        background: rgba(0, 0, 0, 0.12);
        border-radius: 8px;
      }

      /* AI chat bubbles */
      .chat-bubble {
        max-width: 85%;
        word-wrap: break-word;
      }

      @media (prefers-color-scheme: dark) {
        body {
          background: #0b1020;
        }
      }
    </style>
  </head>
  <body class="min-h-screen text-sm text-gray-800">
    <!-- Navigation -->
    <nav
      id="navbar"
      class="bg-white/95 backdrop-blur-sm shadow-sm fixed top-0 w-full z-50 transition-transform duration-300 nav-visible"
      role="navigation"
      aria-label="Main Navigation"
    >
      <div class="container mx-auto px-4">
        <div class="flex justify-between items-center py-4">
          <div class="flex items-center space-x-3">
            <!-- Logo -->
            <div class="flex items-center justify-center w-10 h-10 rounded-lg bg-gradient-to-br from-[color:var(--science-blue)] to-indigo-600 text-white shadow">
              <i class="fas fa-code text-lg"></i>
            </div>
            <div>
              <span class="text-xl font-semibold" style="color:var(--shark)">TypeScript Showcase</span>
              <div class="text-xs text-muted" style="color:var(--muted)">Interactive examples, articles & editor</div>
            </div>
          </div>

          <div class="hidden md:flex items-center space-x-6">
            <a href="#features" class="hover:text-[color:var(--science-blue)] transition">Features</a>
            <a href="#examples" class="hover:text-[color:var(--science-blue)] transition">Examples</a>
            <a href="#tryit" class="hover:text-[color:var(--science-blue)] transition">Try It</a>
            <a href="#articles" class="hover:text-[color:var(--science-blue)] transition">Articles</a>
            <a href="#ai-chat" class="hover:text-[color:var(--science-blue)] transition">AI Chat</a>
          </div>

          <div class="md:hidden">
            <button
              id="mobile-menu-button"
              class="btn btn-ghost"
              aria-expanded="false"
              aria-controls="mobile-menu"
              onclick="toggleMobileMenu()"
              title="Open menu"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="md:hidden fixed top-16 left-0 w-full bg-white shadow-lg z-40 mobile-hidden">
      <div class="flex flex-col p-4 space-y-3">
        <a href="#features" class="text-gray-700 hover:text-[color:var(--science-blue)] py-2" onclick="toggleMobileMenu()">Features</a>
        <a href="#examples" class="text-gray-700 hover:text-[color:var(--science-blue)] py-2" onclick="toggleMobileMenu()">Examples</a>
        <a href="#tryit" class="text-gray-700 hover:text-[color:var(--science-blue)] py-2" onclick="toggleMobileMenu()">Try It</a>
        <a href="#articles" class="text-gray-700 hover:text-[color:var(--science-blue)] py-2" onclick="toggleMobileMenu()">Articles</a>
        <a href="#ai-chat" class="text-gray-700 hover:text-[color:var(--science-blue)] py-2" onclick="toggleMobileMenu()">AI Chat</a>
      </div>
    </div>

    <!-- Hero -->
    <section class="pt-24 pb-12">
      <div class="container mx-auto px-4 text-center">
        <h1 class="text-4xl md:text-5xl font-extrabold mb-4" style="color:var(--shark)">Professional TypeScript Showcase</h1>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto mb-6">
          Explore advanced TypeScript features and patterns with interactive editors, runnable examples, helpful articles, and an AI assistant to guide you.
        </p>
        <div class="flex justify-center gap-4">
          <a href="#tryit" class="btn" style="background:var(--science-blue); color:white">Try Examples</a>
          <a href="#articles" class="btn btn-outline">Read Articles</a>
        </div>
      </div>
    </section>

    <!-- Features -->
    <section id="features" class="py-12">
      <div class="container mx-auto px-4">
        <h2 class="text-3xl font-bold text-center mb-8" style="color:var(--shark)">TypeScript Features</h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- 6 cards -->
          <div class="feature-card card bg-white rounded-lg p-5 shadow">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-full bg-blue-50 flex items-center justify-center">
                <i class="fas fa-code-branch text-[color:var(--science-blue)] text-xl"></i>
              </div>
              <div>
                <h3 class="font-semibold text-lg">Union Types</h3>
                <p class="text-sm text-gray-600">Combine multiple types to accept different kinds of values safely.</p>
                <div class="mt-3 text-right">
                  <button class="btn btn-ghost btn-sm" onclick="showArticle(0)">Learn more</button>
                </div>
              </div>
            </div>
          </div>

          <div class="feature-card card bg-white rounded-lg p-5 shadow">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-full bg-emerald-50 flex items-center justify-center">
                <i class="fas fa-shield-alt text-emerald-600 text-xl"></i>
              </div>
              <div>
                <h3 class="font-semibold text-lg">Type Guards</h3>
                <p class="text-sm text-gray-600">Narrow types at runtime using checks and custom guards.</p>
                <div class="mt-3 text-right">
                  <button class="btn btn-ghost btn-sm" onclick="showArticle(1)">Learn more</button>
                </div>
              </div>
            </div>
          </div>

          <div class="feature-card card bg-white rounded-lg p-5 shadow">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-full bg-purple-50 flex items-center justify-center">
                <i class="fas fa-link text-purple-600 text-xl"></i>
              </div>
              <div>
                <h3 class="font-semibold text-lg">Optional Chaining</h3>
                <p class="text-sm text-gray-600">Safely access nested values without verbose checks.</p>
                <div class="mt-3 text-right">
                  <button class="btn btn-ghost btn-sm" onclick="showArticle(2)">Learn more</button>
                </div>
              </div>
            </div>
          </div>

          <div class="feature-card card bg-white rounded-lg p-5 shadow">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-full bg-yellow-50 flex items-center justify-center">
                <i class="fas fa-cogs text-yellow-600 text-xl"></i>
              </div>
              <div>
                <h3 class="font-semibold text-lg">Generics</h3>
                <p class="text-sm text-gray-600">Create reusable components and functions that preserve type information.</p>
                <div class="mt-3 text-right">
                  <button class="btn btn-ghost btn-sm" onclick="showArticle(3)">Learn more</button>
                </div>
              </div>
            </div>
          </div>

          <div class="feature-card card bg-white rounded-lg p-5 shadow">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-full bg-red-50 flex items-center justify-center">
                <i class="fas fa-check-circle text-red-600 text-xl"></i>
              </div>
              <div>
                <h3 class="font-semibold text-lg">Type Assertions</h3>
                <p class="text-sm text-gray-600">Tell the compiler what you know about a value when needed.</p>
                <div class="mt-3 text-right">
                  <button class="btn btn-ghost btn-sm" onclick="showArticle(4)">Learn more</button>
                </div>
              </div>
            </div>
          </div>

          <div class="feature-card card bg-white rounded-lg p-5 shadow">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-full bg-indigo-50 flex items-center justify-center">
                <i class="fas fa-filter text-indigo-600 text-xl"></i>
              </div>
              <div>
                <h3 class="font-semibold text-lg">Type Predicates</h3>
                <p class="text-sm text-gray-600">Make custom runtime checks that narrow types in conditionals.</p>
                <div class="mt-3 text-right">
                  <button class="btn btn-ghost btn-sm" onclick="showArticle(5)">Learn more</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Articles (now 6 full articles) -->
    <section id="articles" class="py-12 bg-[color:var(--athens-gray)]">
      <div class="container mx-auto px-4 max-w-5xl">
        <h2 class="text-3xl font-bold text-center mb-8" style="color:var(--shark)">TypeScript Articles</h2>

        <div class="space-y-6">
          <!-- Article 0: Union Types -->
          <article class="bg-white rounded-xl shadow overflow-hidden">
            <div class="article-header p-5 border-b cursor-pointer" onclick="toggleArticle(0)">
              <h3 class="flex justify-between items-center text-lg font-semibold">
                <span>Understanding Union Types in TypeScript</span>
                <i class="fas fa-chevron-down text-gray-400"></i>
              </h3>
            </div>
            <div class="article-content">
              <div class="p-5">
                <p class="text-gray-600 mb-4">Union types allow a value to be one of several types. They are declared with the pipe (<code>|</code>) operator and are extremely useful when data can be multiple shapes.</p>
                <pre class="bg-slate-900 text-white p-4 rounded-lg mb-4"><code class="language-typescript">// Defining a union type
type ID = string | number;

function printID(id: ID) {
  if (typeof id === "string") {
    console.log(id.toUpperCase());
  } else {
    console.log(id.toFixed(2));
  }
}</code></pre>
                <p class="text-gray-600">Use unions with discriminated union patterns for safe, expressive code.</p>
              </div>
            </div>
          </article>

          <!-- Article 1: Type Guards -->
          <article class="bg-white rounded-xl shadow overflow-hidden">
            <div class="article-header p-5 border-b cursor-pointer" onclick="toggleArticle(1)">
              <h3 class="flex justify-between items-center text-lg font-semibold">
                <span>Type Guards for Runtime Safety</span>
                <i class="fas fa-chevron-down text-gray-400"></i>
              </h3>
            </div>
            <div class="article-content">
              <div class="p-5">
                <p class="text-gray-600 mb-4">Type guards are functions or expressions that refine types within a scope so TypeScript can guarantee behavior safely at runtime.</p>
                <pre class="bg-slate-900 text-white p-4 rounded-lg mb-4"><code class="language-typescript">// Type guard example
function isString(value: any): value is string {
  return typeof value === "string";
}

function doWork(value: string | number) {
  if (isString(value)) {
    // TS now knows value is string
    console.log(value.trim());
  } else {
    console.log(value.toFixed(2));
  }
}</code></pre>
                <p class="text-gray-600">Custom type guards are especially helpful when working with complex unions or external JSON data.</p>
              </div>
            </div>
          </article>

          <!-- Article 2: Optional Chaining -->
          <article class="bg-white rounded-xl shadow overflow-hidden">
            <div class="article-header p-5 border-b cursor-pointer" onclick="toggleArticle(2)">
              <h3 class="flex justify-between items-center text-lg font-semibold">
                <span>Optional Chaining and Nullish Coalescing</span>
                <i class="fas fa-chevron-down text-gray-400"></i>
              </h3>
            </div>
            <div class="article-content">
              <div class="p-5">
                <p class="text-gray-600 mb-4">Optional chaining (<code>?.</code>) and nullish coalescing (<code>??</code>) let you write concise, safe access & defaulting for deep data structures.</p>
                <pre class="bg-slate-900 text-white p-4 rounded-lg mb-4"><code class="language-typescript">interface User {
  name: string;
  address?: {
    city?: string;
  };
}

const city = user.address?.city ?? "Unknown";</code></pre>
                <p class="text-gray-600">They greatly reduce boilerplate for APIs that frequently omit nested fields.</p>
              </div>
            </div>
          </article>

          <!-- Article 3: Generics -->
          <article class="bg-white rounded-xl shadow overflow-hidden">
            <div class="article-header p-5 border-b cursor-pointer" onclick="toggleArticle(3)">
              <h3 class="flex justify-between items-center text-lg font-semibold">
                <span>Generics — Reusable, Typed Building Blocks</span>
                <i class="fas fa-chevron-down text-gray-400"></i>
              </h3>
            </div>
            <div class="article-content">
              <div class="p-5">
                <p class="text-gray-600 mb-4">Generics let you define components and functions that work over many types while preserving type information.</p>
                <pre class="bg-slate-900 text-white p-4 rounded-lg mb-4"><code class="language-typescript">function identity<T>(value: T): T {
  return value;
}

const n = identity<number>(42);
const s = identity<string>("hello");</code></pre>
                <p class="text-gray-600">Generics power typed data structures and APIs in large codebases.</p>
              </div>
            </div>
          </article>

          <!-- Article 4: Type Assertions -->
          <article class="bg-white rounded-xl shadow overflow-hidden">
            <div class="article-header p-5 border-b cursor-pointer" onclick="toggleArticle(4)">
              <h3 class="flex justify-between items-center text-lg font-semibold">
                <span>Type Assertions — Use When You Know More</span>
                <i class="fas fa-chevron-down text-gray-400"></i>
              </h3>
            </div>
            <div class="article-content">
              <div class="p-5">
                <p class="text-gray-600 mb-4">Type assertions (the <code>as</code> syntax) let you tell TypeScript a value is more specific than the compiler can infer. Use sparingly — prefer proper types where possible.</p>
                <pre class="bg-slate-900 text-white p-4 rounded-lg mb-4"><code class="language-typescript">const el = document.getElementById("name") as HTMLInputElement;
console.log(el.value);</code></pre>
                <p class="text-gray-600">Assertions do not change runtime behavior — they only affect the type system.</p>
              </div>
            </div>
          </article>

          <!-- Article 5: Type Predicates -->
          <article class="bg-white rounded-xl shadow overflow-hidden">
            <div class="article-header p-5 border-b cursor-pointer" onclick="toggleArticle(5)">
              <h3 class="flex justify-between items-center text-lg font-semibold">
                <span>Type Predicates — Custom Narrowing Functions</span>
                <i class="fas fa-chevron-down text-gray-400"></i>
              </h3>
            </div>
            <div class="article-content">
              <div class="p-5">
                <p class="text-gray-600 mb-4">Type predicates are functions that assert the type of a value when called, letting TypeScript narrow types in branches.</p>
                <pre class="bg-slate-900 text-white p-4 rounded-lg mb-4"><code class="language-typescript">function isDate(value: any): value is Date {
  return value instanceof Date;
}

if (isDate(x)) {
  // TS knows x is Date here
  console.log(x.toISOString());
}</code></pre>
                <p class="text-gray-600">Useful when distinguishing custom runtime shapes or models.</p>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- Examples + Try It (Editor) -->
    <section id="examples" class="py-12">
      <div class="container mx-auto px-4 max-w-6xl">
        <h2 class="text-3xl font-bold text-center mb-6" style="color:var(--shark)">TypeScript Examples & Interactive Editor</h2>

        <!-- Tabs -->
        <div class="tabs tabs-boxed justify-center mb-6 bg-white p-1 rounded-lg">
          <a class="tab tab-active" data-example="0" onclick="showExampleIndex(0)">Union Types</a>
          <a class="tab" data-example="1" onclick="showExampleIndex(1)">Optional Chaining</a>
          <a class="tab" data-example="2" onclick="showExampleIndex(2)">Type Guards</a>
          <a class="tab" data-example="3" onclick="showExampleIndex(3)">Generics</a>
          <a class="tab" data-example="4" onclick="showExampleIndex(4)">Type Assertions</a>
          <a class="tab" data-example="5" onclick="showExampleIndex(5)">Type Predicates</a>
        </div>

        <div class="bg-white rounded-xl shadow overflow-hidden">
          <div class="p-5 border-b">
            <h3 id="example-title" class="font-semibold text-lg">Union Types Example</h3>
            <p id="example-description" class="text-sm text-gray-600 mt-1">Function that accepts both string and number types and returns different results based on the input type.</p>
          </div>

          <div class="p-5 bg-slate-900 text-white">
            <pre class="code-block"><code id="example-code" class="language-typescript">// Example code will appear here</code></pre>
          </div>

          <div class="p-5 border-t">
            <div class="flex flex-col md:flex-row md:items-center gap-3">
              <input id="example-input" type="text" placeholder="Enter input" class="input input-bordered flex-grow" />
              <button class="btn" style="background:var(--science-blue); color:white" onclick="runCurrentExample()">Run Example</button>
            </div>

            <div class="mt-4 p-4 bg-[color:var(--athens-gray)] rounded-lg">
              <p class="font-medium text-gray-700">Output:</p>
              <pre id="example-output" class="mt-2 text-gray-800 bg-white p-3 rounded-md">Results will appear here</pre>
            </div>
          </div>
        </div>

        <!-- Editor + Output -->
        <div id="tryit" class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
          <div class="bg-slate-900 rounded-xl overflow-hidden shadow">
            <div class="p-4 bg-slate-800 text-white font-medium">TypeScript Editor</div>
            <div class="p-4">
              <textarea id="typescript-code" spellcheck="false" class="w-full h-64 bg-[#0f1724] text-white p-4 rounded-lg font-mono text-sm" placeholder="// Write TypeScript here...">
// Write your TypeScript code here
function greet(name: string): string {
  return `Hello, ${name}!`;
}

const result = greet("TypeScript");
console.log(result);
              </textarea>
            </div>
            <div class="p-4 border-t border-slate-700 flex gap-3">
              <button class="btn" style="background:var(--science-blue); color:white" onclick="compileAndRun()">Compile & Run</button>
              <button class="btn btn-ghost" onclick="downloadCode()">Download .ts</button>
              <div class="ml-auto text-xs text-gray-400">Using in-browser TypeScript compiler</div>
            </div>
          </div>

          <div class="bg-white rounded-xl overflow-hidden shadow">
            <div class="p-4 bg-gray-100 text-gray-800 font-medium">Output</div>
            <div class="p-4">
              <pre id="output-code" class="h-64 bg-white p-4 rounded-lg overflow-auto">// Output will appear here</pre>
            </div>
            <div class="p-4 border-t border-gray-200">
              <div class="flex items-center gap-2 text-gray-600">
                <i class="fas fa-info-circle"></i>
                <span class="text-sm">Compiled with TypeScript's <code>transpileModule</code> in the browser where available.</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- AI Chatbot -->
    <section id="ai-chat" class="py-12 bg-[color:var(--athens-gray)]">
      <div class="container mx-auto px-4 max-w-4xl">
        <h2 class="text-2xl font-bold text-center mb-4" style="color:var(--shark)">AI Assistant (Local)</h2>
        <p class="text-center text-gray-600 mb-6">A helpful on-page assistant to answer common TypeScript & site questions. (This is a local, rule-based assistant — not connected to external APIs.)</p>

        <div class="bg-white rounded-xl shadow overflow-hidden">
          <div id="chat-area" class="p-4 h-80 overflow-auto space-y-3"></div>

          <div class="p-4 border-t flex gap-2">
            <input id="chat-input" class="input input-bordered flex-grow" placeholder="Ask: e.g. 'how to use generics?' or 'run the editor code'" />
            <button class="btn" style="background:var(--science-blue); color:white" onclick="sendChat()">Send</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="bg-[color:var(--shark)] text-white py-8">
      <div class="container mx-auto px-4 max-w-6xl">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <h3 class="text-lg font-semibold">TypeScript Showcase</h3>
            <p class="text-sm text-gray-300 mt-2">Professional interactive playground, articles, and local AI helper — designed to help you learn TypeScript.</p>
          </div>
          <div>
            <h3 class="text-lg font-semibold">Quick Links</h3>
            <ul class="space-y-2 mt-2">
              <li><a href="#features" class="text-gray-300 hover:text-white">Features</a></li>
              <li><a href="#examples" class="text-gray-300 hover:text-white">Examples</a></li>
              <li><a href="#tryit" class="text-gray-300 hover:text-white">Try It</a></li>
              <li><a href="#articles" class="text-gray-300 hover:text-white">Articles</a></li>
            </ul>
          </div>
          <div>
            <h3 class="text-lg font-semibold">Resources</h3>
            <ul class="space-y-2 mt-2">
              <li><a href="https://www.typescriptlang.org/" class="text-gray-300 hover:text-white">TypeScript Docs</a></li>
              <li><a href="https://github.com/microsoft/TypeScript" class="text-gray-300 hover:text-white">TypeScript on GitHub</a></li>
              <li><a href="https://www.typescriptlang.org/play" class="text-gray-300 hover:text-white">Playground</a></li>
            </ul>
          </div>
        </div>

        <div class="mt-6 text-center text-gray-400 text-xs">&copy; 2025 TypeScript Showcase. All rights reserved.</div>
      </div>
    </footer>

    <script>
      // Initialize highlight.js
      hljs.highlightAll();

      /* ----------------------------
         EXAMPLES: Data + behavior
         ---------------------------- */
      const examples = [
        {
          title: "Union Types Example",
          description:
            "Function that accepts both string and number types and returns different results based on the input type.",
          code: `function reLengthOrNumber(name: string | number): number {
  if (typeof name === "string") {
    return name.length;
  } else {
    return name * name;
  }
}`,
          run: (input) => {
            try {
              const parsedInput = input === "" ? "" : (isNaN(input) ? input : Number(input));
              return reLengthOrNumber(parsedInput);
            } catch (e) {
              return "Error: " + (e && e.message ? e.message : e);
            }
          },
        },
        {
          title: "Optional Chaining Example",
          description:
            "Safely access nested properties with optional chaining to avoid runtime errors.",
          code: `interface Address {
  city: string;
  street: string;
}

interface Person {
  phone?: string;
  address?: Address;
}

const getAddressCity = (person: Person): string | undefined => {
  return person.address?.city;
}`,
          run: (input) => {
            try {
              const testPerson = {
                name: "John",
                address: input === "withAddress" ? { city: "New York", street: "Broadway" } : undefined,
              };
              return getAddressCity(testPerson) || "No address found";
            } catch (e) {
              return "Error: " + (e && e.message ? e.message : e);
            }
          },
        },
        {
          title: "Type Guards Example",
          description:
            "Using type guards to narrow down types and ensure type safety at runtime.",
          code: `class Cat {
  meow() {
    return "Meow!";
  }
}

const isCat = (obj: any): obj is Cat => {
  return obj instanceof Cat;
}

const checkCat = (obj: any): string => {
  if (isCat(obj)) {
    return "Yes, it's a cat: " + obj.meow();
  } else {
    return "No, it's not a cat";
  }
}`,
          run: (input) => {
            try {
              if (input === "cat") {
                return checkCat(new Cat());
              } else {
                return checkCat({ bark: () => "Woof!" });
              }
            } catch (e) {
              return "Error: " + (e && e.message ? e.message : e);
            }
          },
        },
        {
          title: "Generics Example",
          description:
            "Using generics to create reusable components that work with multiple types.",
          code: `const findFirstOccurrence = <T>(arr: T[], value: T): number => {
  return arr.indexOf(value);
}

const numbers: number[] = [1, 2, 3, 4, 5, 2];
const strings: string[] = ['apple', "banana", "cherry", "data", "apple"];`,
          run: (input) => {
            try {
              const numbers = [1, 2, 3, 4, 5, 2];
              const strings = ["apple", "banana", "cherry", "data", "apple"];
              if (input === "number") {
                return `Index of 2 in numbers: ${findFirstOccurrence(numbers, 2)}`;
              } else {
                return `Index of "cherry" in strings: ${findFirstOccurrence(strings, "cherry")}`;
              }
            } catch (e) {
              return "Error: " + (e && e.message ? e.message : e);
            }
          },
        },
        {
          title: "Type Assertions Example",
          description:
            "Using type assertions to tell the compiler to treat a value as a specific type.",
          code: `const simpleOfMixedData = (mixedData: string | number) => {
  if (typeof mixedData === "string") {
    const convertNumber = parseFloat(mixedData) * 1000;
    return \`this is : \${convertNumber}\`;
  }
  if (typeof mixedData === "number") {
    return mixedData * 1000;
  }
}`,
          run: (input) => {
            try {
              const parsedInput = isNaN(input) ? input : Number(input);
              return simpleOfMixedData(parsedInput);
            } catch (e) {
              return "Error: " + (e && e.message ? e.message : e);
            }
          },
        },
        {
          title: "Type Predicates Example",
          description:
            "Create functions that perform runtime checks and narrow types in conditional blocks.",
          code: `function isDate(value: any): value is Date {
  return value instanceof Date;
}

function showDate(d: any) {
  if (isDate(d)) {
    return d.toISOString();
  }
  return "Not a date";
}`,
          run: (input) => {
            try {
              if (input === "date") {
                return showDate(new Date());
              } else {
                return showDate("not a date");
              }
            } catch (e) {
              return "Error: " + (e && e.message ? e.message : e);
            }
          },
        },
      ];

      // Expose example functions to global scope for run() behavior
      function reLengthOrNumber(name) {
        if (typeof name === "string") {
          return name.length;
        } else {
          return name * name;
        }
      }
      function getAddressCity(person) {
        return person.address?.city;
      }
      class Cat {
        meow() {
          return "Meow!";
        }
      }
      const isCat = (obj) => obj instanceof Cat;
      const checkCat = (obj) => (isCat(obj) ? "Yes, it's a cat: " + obj.meow() : "No, it's not a cat");
      function simpleOfMixedData(mixedData) {
        if (typeof mixedData === "string") {
          const convertNumber = parseFloat(mixedData) * 1000;
          return `this is : ${convertNumber}`;
        }
        if (typeof mixedData === "number") {
          return mixedData * 1000;
        }
      }
      function findFirstOccurrence(arr, value) {
        return arr.indexOf(value);
      }
      function isDate(value) {
        return value instanceof Date;
      }
      function showDate(d) {
        if (isDate(d)) return d.toISOString();
        return "Not a date";
      }

      let currentExampleIndex = 0;

      function showExampleIndex(i) {
        currentExampleIndex = i;
        const ex = examples[i];
        document.getElementById("example-title").textContent = ex.title;
        document.getElementById("example-description").textContent = ex.description;
        document.getElementById("example-code").textContent = ex.code;
        document.getElementById("example-input").placeholder = "Enter input for the example";
        // update tab active classes
        document.querySelectorAll(".tab").forEach((tab, idx) => {
          if (idx === i) tab.classList.add("tab-active");
          else tab.classList.remove("tab-active");
        });
        // re-highlight
        hljs.highlightAll();
      }

      function runCurrentExample() {
        const input = document.getElementById("example-input").value;
        const out = examples[currentExampleIndex].run(input);
        document.getElementById("example-output").textContent = typeof out === "object" ? JSON.stringify(out, null, 2) : String(out);
      }

      // Initialize first example
      showExampleIndex(0);

      /* ----------------------------
         MOBILE MENU + NAV hide on scroll
         ---------------------------- */
      let lastScrollTop = 0;
      window.addEventListener("scroll", function () {
        const navbar = document.getElementById("navbar");
        const mobileMenu = document.getElementById("mobile-menu");
        const st = window.pageYOffset || document.documentElement.scrollTop;
        if (st > lastScrollTop && st > 120) {
          // scrolling down
          navbar.classList.add("nav-hidden");
          mobileMenu.classList.add("mobile-hidden");
          document.getElementById("mobile-menu-button").setAttribute("aria-expanded", "false");
        } else {
          navbar.classList.remove("nav-hidden");
        }
        lastScrollTop = st <= 0 ? 0 : st;
      });

      function toggleMobileMenu() {
        const menu = document.getElementById("mobile-menu");
        const btn = document.getElementById("mobile-menu-button");
        if (menu.classList.contains("mobile-hidden")) {
          menu.classList.remove("mobile-hidden");
          menu.classList.add("nav-visible");
          btn.setAttribute("aria-expanded", "true");
        } else {
          menu.classList.add("mobile-hidden");
          btn.setAttribute("aria-expanded", "false");
        }
      }

      // Close mobile menu when click outside on small screens
      document.addEventListener("click", function (e) {
        const mobileMenu = document.getElementById("mobile-menu");
        const mobileBtn = document.getElementById("mobile-menu-button");
        if (!mobileMenu.contains(e.target) && !mobileBtn.contains(e.target)) {
          if (!mobileMenu.classList.contains("mobile-hidden")) {
            mobileMenu.classList.add("mobile-hidden");
            mobileBtn.setAttribute("aria-expanded", "false");
          }
        }
      });

      /* ----------------------------
         Articles toggle
         ---------------------------- */
      function toggleArticle(idx) {
        const articles = document.querySelectorAll(".article-content");
        const article = articles[idx];
        if (!article) return;
        article.classList.toggle("show");
        // toggle icon rotation
        const chevron = article.parentElement.querySelector(".fa-chevron-down");
        if (chevron) chevron.classList.toggle("fa-rotate-180");
        // re-highlight code inside opened article
        hljs.highlightAll();
      }

      function showArticle(index) {
        // close others
        document.querySelectorAll(".article-content").forEach((n) => n.classList.remove("show"));
        document.querySelectorAll(".fa-chevron-down").forEach((c) => c.classList.remove("fa-rotate-180"));
        // open requested
        toggleArticle(index);
        document.getElementById("articles").scrollIntoView({ behavior: "smooth" });
      }

      /* ----------------------------
         TypeScript compile & run (in-browser)
         Uses ts.transpileModule when available (from typescriptServices.js)
         ---------------------------- */
      function compileAndRun() {
        const code = document.getElementById("typescript-code").value;
        const outEl = document.getElementById("output-code");

        // try to compile with ts if available
        let js = "";
        try {
          if (window.ts && typeof window.ts.transpileModule === "function") {
            const result = ts.transpileModule(code, { compilerOptions: { module: ts.ModuleKind.ES2015, target: ts.ScriptTarget.ES2017 } });
            js = result.outputText;
          } else {
            // fallback: naive removal of simple types (less reliable)
            js = code.replace(/:\s*any|:\s*string|:\s*number|:\s*boolean|<\w+>/g, "");
          }
        } catch (e) {
          outEl.textContent = "TypeScript compile error: " + (e && e.message ? e.message : e);
          return;
        }

        // Capture console logs
        const originalConsole = console.log;
        let captured = "";
        console.log = function (...args) {
          // stringify safely
          captured += args.map(a => (typeof a === "object" ? JSON.stringify(a, null, 2) : String(a))).join(" ") + "\n";
        };

        try {
          // Use Function constructor to execute safely in local scope
          new Function(js)();
          outEl.textContent = captured || "Code executed successfully (no console output)";
        } catch (e) {
          outEl.textContent = "Runtime error: " + (e && e.message ? e.message : e);
        } finally {
          console.log = originalConsole;
        }
      }

      function downloadCode() {
        const code = document.getElementById("typescript-code").value;
        const blob = new Blob([code], { type: "text/typescript" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "code.ts";
        a.click();
        URL.revokeObjectURL(url);
      }

      /* ----------------------------
         Simple local AI Chatbot (rule-based)
         ---------------------------- */
      const chatArea = document.getElementById("chat-area");
      const canned = [
        { q: /hello|hi|hey/i, a: "Hi there! 👋 Ask me about TypeScript features (eg. 'what is a union type?'), or say 'run the editor' to execute the code in the editor." },
        { q: /union/i, a: "Union types let a value be one of several types. Example: `type ID = string | number;`" },
        { q: /generic/i, a: "Generics let you write reusable code: `function identity<T>(x: T): T { return x }`" },
        { q: /how to run|run the editor/i, a: "Click the 'Compile & Run' button in the Try It section. That compiles TypeScript in your browser and runs it." },
        { q: /compile|typescript in browser/i, a: "This page uses TypeScript's `transpileModule` in the browser. It's great for snippets but not a full build system." },
        { q: /examples|show example/i, a: "Use the Examples section — choose a tab and run with the input field. Try 'cat' on Type Guards or 'withAddress' for Optional Chaining." },
      ];

      function createChatBubble(text, from = "bot") {
        const wrapper = document.createElement("div");
        wrapper.className = from === "user" ? "flex justify-end" : "flex justify-start";
        const bubble = document.createElement("div");
        bubble.className = "chat-bubble p-3 rounded-lg shadow " + (from === "user" ? "bg-[color:var(--science-blue)] text-white" : "bg-gray-100 text-gray-800");
        bubble.innerHTML = text;
        wrapper.appendChild(bubble);
        chatArea.appendChild(wrapper);
        chatArea.scrollTop = chatArea.scrollHeight;
      }

      function sendChat() {
        const input = document.getElementById("chat-input");
        const value = input.value.trim();
        if (!value) return;
        createChatBubble(escapeHtml(value), "user");
        input.value = "";
        // simple rule match
        let response = "Sorry — I don't know that. Try asking about 'union types', 'generics', or 'how to run the editor'.";
        for (const rule of canned) {
          if (rule.q.test(value)) {
            response = rule.a;
            break;
          }
        }

        // small special: "run the editor" triggers compile
        if (/run the editor|run code|execute code/i.test(value)) {
          createChatBubble("Running the editor code now...", "bot");
          setTimeout(() => {
            compileAndRun();
            createChatBubble("Done — check the Output panel. (If output shows no logs, add console.log statements in your code.)", "bot");
          }, 400);
          return;
        }

        setTimeout(() => createChatBubble(escapeHtml(response), "bot"), 250);
      }

      function escapeHtml(s) {
        return s.replace(/[&<>"']/g, function (c) {
          return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c];
        });
      }

      // Init chat with greeting
      createChatBubble("Hello! I'm your TypeScript helper. Ask me about TypeScript features, examples, or run the editor (type 'run the editor').", "bot");

      // keyboard shortcut for chat input (enter)
      document.getElementById("chat-input").addEventListener("keydown", function (e) {
        if (e.key === "Enter") {
          e.preventDefault();
          sendChat();
        }
      });

      // small utility to re-run highlight after dynamic code injection
      document.addEventListener("DOMContentLoaded", () => {
        hljs.highlightAll();
      });
    </script>
  </body>
</html>
